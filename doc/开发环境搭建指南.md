# SkyEye 智能监控系统 - 开发环境搭建指南

## 文档说明
本文档详细说明了SkyEye智能监控系统的开发环境搭建步骤，包括所需软件安装、配置和项目初始化。

---

## 1. 开发环境要求

### 1.1 基础软件要求
- **操作系统**：Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **JDK**：OpenJDK 17 或 Oracle JDK 17
- **IDE**：IntelliJ IDEA 2023.1+ 或 VS Code with Java Extension Pack
- **数据库**：PostgreSQL 15+
- **缓存**：Redis 7.0+
- **构建工具**：Maven 3.8+
- **版本控制**：Git 2.30+

### 1.2 推荐配置
- **内存**：16GB RAM (最低8GB)
- **存储**：SSD 50GB+ 可用空间
- **CPU**：4核心以上

---

## 2. 软件安装

### 2.1 安装JDK 17

#### Windows
```bash
# 使用Chocolatey安装
choco install openjdk17

# 或下载安装包
# https://adoptium.net/temurin/releases/
```

#### macOS
```bash
# 使用Homebrew安装
brew install openjdk@17

# 设置环境变量
echo 'export PATH="/opt/homebrew/opt/openjdk@17/bin:$PATH"' >> ~/.zshrc
echo 'export JAVA_HOME="/opt/homebrew/opt/openjdk@17"' >> ~/.zshrc
source ~/.zshrc
```

#### Ubuntu/Linux
```bash
# 安装OpenJDK 17
sudo apt update
sudo apt install openjdk-17-jdk

# 设置环境变量
echo 'export JAVA_HOME=/usr/lib/jvm/java-17-openjdk-amd64' >> ~/.bashrc
echo 'export PATH=$PATH:$JAVA_HOME/bin' >> ~/.bashrc
source ~/.bashrc
```

#### 验证安装
```bash
java -version
javac -version
```

### 2.2 安装Maven

#### Windows
```bash
# 使用Chocolatey
choco install maven

# 手动安装
# 1. 下载 https://maven.apache.org/download.cgi
# 2. 解压到 C:\Program Files\Apache\maven
# 3. 添加到PATH环境变量
```

#### macOS
```bash
# 使用Homebrew
brew install maven
```

#### Ubuntu/Linux
```bash
# 使用包管理器
sudo apt install maven

# 或手动安装
wget https://archive.apache.org/dist/maven/maven-3/3.9.5/binaries/apache-maven-3.9.5-bin.tar.gz
tar -xzf apache-maven-3.9.5-bin.tar.gz
sudo mv apache-maven-3.9.5 /opt/maven
echo 'export M2_HOME=/opt/maven' >> ~/.bashrc
echo 'export PATH=$PATH:$M2_HOME/bin' >> ~/.bashrc
source ~/.bashrc
```

#### 验证安装
```bash
mvn -version
```

### 2.3 安装PostgreSQL

#### Windows
```bash
# 使用Chocolatey
choco install postgresql

# 或下载安装包
# https://www.postgresql.org/download/windows/
```

#### macOS
```bash
# 使用Homebrew
brew install postgresql@15
brew services start postgresql@15

# 创建数据库用户
createuser -s postgres
```

#### Ubuntu/Linux
```bash
# 安装PostgreSQL
sudo apt update
sudo apt install postgresql postgresql-contrib

# 启动服务
sudo systemctl start postgresql
sudo systemctl enable postgresql

# 设置postgres用户密码
sudo -u postgres psql
\password postgres
\q
```

#### 配置数据库
```sql
-- 连接到PostgreSQL
psql -U postgres -h localhost

-- 创建数据库
CREATE DATABASE skyeye WITH ENCODING='UTF8' LC_COLLATE='zh_CN.UTF-8' LC_CTYPE='zh_CN.UTF-8';

-- 创建应用用户
CREATE USER skyeye_app WITH PASSWORD 'skyeye_app_2024';

-- 授权
GRANT ALL PRIVILEGES ON DATABASE skyeye TO skyeye_app;

-- 退出
\q
```

### 2.4 安装Redis

#### Windows
```bash
# 使用Chocolatey
choco install redis-64

# 启动Redis服务
redis-server
```

#### macOS
```bash
# 使用Homebrew
brew install redis
brew services start redis

# 测试连接
redis-cli ping
```

#### Ubuntu/Linux
```bash
# 安装Redis
sudo apt update
sudo apt install redis-server

# 启动服务
sudo systemctl start redis-server
sudo systemctl enable redis-server

# 测试连接
redis-cli ping
```

### 2.5 安装IDE

#### IntelliJ IDEA
1. 下载并安装 [IntelliJ IDEA](https://www.jetbrains.com/idea/)
2. 安装必要插件：
   - Spring Boot
   - Database Navigator
   - GitToolBox
   - SonarLint
   - Lombok

#### VS Code (可选)
```bash
# 安装VS Code
# https://code.visualstudio.com/

# 安装Java扩展包
code --install-extension vscjava.vscode-java-pack
code --install-extension redhat.vscode-spring-boot
code --install-extension ms-vscode.vscode-spring-boot-dashboard
```

---

## 3. 项目初始化

### 3.1 创建Spring Boot项目

#### 使用Spring Initializr
1. 访问 [Spring Initializr](https://start.spring.io/)
2. 配置项目参数：
   - Project: Maven
   - Language: Java
   - Spring Boot: 3.2.0
   - Group: com.skyeye
   - Artifact: skyeye-monitoring
   - Name: SkyEye Monitoring System
   - Package name: com.skyeye
   - Packaging: Jar
   - Java: 17

3. 添加依赖：
   - Spring Web
   - Spring Data JPA
   - Spring Security
   - Spring Boot DevTools
   - PostgreSQL Driver
   - Spring Data Redis
   - Validation

#### 项目结构
```
skyeye-monitoring/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/
│   │   │       └── skyeye/
│   │   │           ├── SkyEyeApplication.java
│   │   │           ├── common/
│   │   │           ├── config/
│   │   │           ├── security/
│   │   │           ├── auth/
│   │   │           ├── user/
│   │   │           ├── device/
│   │   │           ├── collector/
│   │   │           ├── monitoring/
│   │   │           ├── alert/
│   │   │           ├── analytics/
│   │   │           ├── task/
│   │   │           ├── history/
│   │   │           └── system/
│   │   └── resources/
│   │       ├── application.yml
│   │       ├── application-dev.yml
│   │       ├── application-prod.yml
│   │       └── db/
│   │           └── migration/
│   └── test/
├── pom.xml
├── README.md
└── .gitignore
```

### 3.2 配置pom.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" 
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
        <relativePath/>
    </parent>
    
    <groupId>com.skyeye</groupId>
    <artifactId>skyeye-monitoring</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <name>SkyEye Monitoring System</name>
    <description>智能监控系统后端服务</description>
    
    <properties>
        <java.version>17</java.version>
        <jwt.version>0.11.5</jwt.version>
        <snmp4j.version>3.7.7</snmp4j.version>
        <commons-lang3.version>3.12.0</commons-lang3.version>
    </properties>
    
    <dependencies>
        <!-- Spring Boot Starters -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-security</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-redis</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-websocket</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-cache</artifactId>
        </dependency>
        
        <!-- Database -->
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
            <scope>runtime</scope>
        </dependency>
        
        <!-- JWT -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-api</artifactId>
            <version>${jwt.version}</version>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-impl</artifactId>
            <version>${jwt.version}</version>
            <scope>runtime</scope>
        </dependency>
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-jackson</artifactId>
            <version>${jwt.version}</version>
            <scope>runtime</scope>
        </dependency>
        
        <!-- SNMP -->
        <dependency>
            <groupId>org.snmp4j</groupId>
            <artifactId>snmp4j</artifactId>
            <version>${snmp4j.version}</version>
        </dependency>
        
        <!-- Utilities -->
        <dependency>
            <groupId>org.apache.commons</groupId>
            <artifactId>commons-lang3</artifactId>
            <version>${commons-lang3.version}</version>
        </dependency>
        
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        
        <!-- Development Tools -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-devtools</artifactId>
            <scope>runtime</scope>
            <optional>true</optional>
        </dependency>
        
        <!-- Test Dependencies -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-test</artifactId>
            <scope>test</scope>
        </dependency>
        
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>junit-jupiter</artifactId>
            <scope>test</scope>
        </dependency>
        
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>postgresql</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
            
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
                <configuration>
                    <source>17</source>
                    <target>17</target>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

### 3.3 配置application.yml

#### application.yml (通用配置)
```yaml
spring:
  application:
    name: skyeye-monitoring
  
  profiles:
    active: dev
  
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        jdbc:
          time_zone: Asia/Shanghai
  
  jackson:
    time-zone: Asia/Shanghai
    date-format: yyyy-MM-dd HH:mm:ss
    default-property-inclusion: non_null
  
  servlet:
    multipart:
      max-file-size: 10MB
      max-request-size: 10MB

# 应用自定义配置
app:
  name: SkyEye智能监控系统
  version: 1.0.0
  
  security:
    jwt:
      secret: ${JWT_SECRET:skyeye-jwt-secret-key-2024}
      expiration: 86400000 # 24小时
  
  collector:
    thread-pool-size: 20
    max-retry-times: 3
    default-timeout: 30
  
  file:
    upload-path: ${FILE_UPLOAD_PATH:/tmp/skyeye/uploads}
    max-size: 10MB

# 监控配置
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when-authorized
  info:
    env:
      enabled: true
    java:
      enabled: true
    os:
      enabled: true

# 日志配置
logging:
  level:
    com.skyeye: INFO
    org.springframework.security: DEBUG
    org.hibernate.SQL: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
    file: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
  file:
    name: logs/skyeye.log
```

#### application-dev.yml (开发环境)
```yaml
spring:
  datasource:
    url: jdbc:postgresql://localhost:5432/skyeye
    username: skyeye_app
    password: skyeye_app_2024
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 20000
      idle-timeout: 300000
      max-lifetime: 1200000
  
  jpa:
    show-sql: true
    hibernate:
      ddl-auto: update
  
  redis:
    host: localhost
    port: 6379
    password: 
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 8
        max-idle: 8
        min-idle: 0
        max-wait: -1ms
  
  devtools:
    restart:
      enabled: true
    livereload:
      enabled: true

# 开发环境日志配置
logging:
  level:
    root: INFO
    com.skyeye: DEBUG
    org.springframework.web: DEBUG
    org.springframework.security: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE

# 开发环境安全配置
app:
  security:
    cors:
      allowed-origins: "http://localhost:3000,http://localhost:8080"
      allowed-methods: "*"
      allowed-headers: "*"
      allow-credentials: true
```

#### application-prod.yml (生产环境)
```yaml
spring:
  datasource:
    url: ${DATABASE_URL:jdbc:postgresql://localhost:5432/skyeye}
    username: ${DATABASE_USERNAME:skyeye_app}
    password: ${DATABASE_PASSWORD:skyeye_app_2024}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 20
      minimum-idle: 10
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  
  jpa:
    show-sql: false
    hibernate:
      ddl-auto: validate
  
  redis:
    host: ${REDIS_HOST:localhost}
    port: ${REDIS_PORT:6379}
    password: ${REDIS_PASSWORD:}
    timeout: 5000ms
    lettuce:
      pool:
        max-active: 16
        max-idle: 8
        min-idle: 2
        max-wait: 3000ms

# 生产环境日志配置
logging:
  level:
    root: WARN
    com.skyeye: INFO
    org.springframework.security: WARN
  file:
    name: /var/log/skyeye/skyeye.log
    max-size: 100MB
    max-history: 30

# 生产环境安全配置
app:
  security:
    cors:
      allowed-origins: ${ALLOWED_ORIGINS:http://localhost:3000}
      allowed-methods: "GET,POST,PUT,DELETE,OPTIONS"
      allowed-headers: "*"
      allow-credentials: true
```

---

## 4. 数据库初始化

### 4.1 创建数据库迁移文件

在 `src/main/resources/db/migration/` 目录下创建SQL文件：

#### V1.0.1__create_user_tables.sql
```sql
-- 用户表
CREATE TABLE tb_users (
    id BIGSERIAL PRIMARY KEY,
    username VARCHAR(50) UNIQUE NOT NULL,
    password VARCHAR(255) NOT NULL,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100),
    phone VARCHAR(20),
    avatar VARCHAR(255),
    status INTEGER DEFAULT 1,
    last_login_ip INET,
    login_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP
);

-- 角色表
CREATE TABLE tb_roles (
    id BIGSERIAL PRIMARY KEY,
    name VARCHAR(50) UNIQUE NOT NULL,
    code VARCHAR(50) UNIQUE NOT NULL,
    description VARCHAR(200),
    is_system BOOLEAN DEFAULT FALSE,
    sort_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 用户角色关联表
CREATE TABLE tb_user_roles (
    user_id BIGINT NOT NULL REFERENCES tb_users(id) ON DELETE CASCADE,
    role_id BIGINT NOT NULL REFERENCES tb_roles(id) ON DELETE CASCADE,
    assigned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    assigned_by BIGINT REFERENCES tb_users(id),
    PRIMARY KEY (user_id, role_id)
);

-- 权限表
CREATE TABLE tb_permissions (
    id BIGSERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    code VARCHAR(100) UNIQUE NOT NULL,
    resource VARCHAR(100) NOT NULL,
    action VARCHAR(50) NOT NULL,
    description VARCHAR(200),
    parent_id BIGINT REFERENCES tb_permissions(id),
    is_menu BOOLEAN DEFAULT FALSE,
    menu_url VARCHAR(200),
    menu_icon VARCHAR(50),
    sort_order INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 角色权限关联表
CREATE TABLE tb_role_permissions (
    role_id BIGINT NOT NULL REFERENCES tb_roles(id) ON DELETE CASCADE,
    permission_id BIGINT NOT NULL REFERENCES tb_permissions(id) ON DELETE CASCADE,
    assigned_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (role_id, permission_id)
);

-- 创建索引
CREATE INDEX idx_users_username ON tb_users (username);
CREATE INDEX idx_users_email ON tb_users (email);
CREATE INDEX idx_users_status ON tb_users (status);

COMMENT ON TABLE tb_users IS '用户信息表';
COMMENT ON TABLE tb_roles IS '角色信息表';
COMMENT ON TABLE tb_user_roles IS '用户角色关联表';
COMMENT ON TABLE tb_permissions IS '权限信息表';
COMMENT ON TABLE tb_role_permissions IS '角色权限关联表';
```

### 4.2 初始化基础数据

#### V1.0.6__init_basic_data.sql
```sql
-- 初始化系统角色
INSERT INTO tb_roles (name, code, description, is_system, sort_order) VALUES
('超级管理员', 'SUPER_ADMIN', '系统超级管理员，拥有所有权限', TRUE, 1),
('系统管理员', 'ADMIN', '系统管理员，管理系统配置和用户', TRUE, 2),
('设备管理员', 'DEVICE_ADMIN', '设备管理员，管理设备和采集任务', TRUE, 3),
('普通用户', 'USER', '普通用户，查看监控数据', TRUE, 4);

-- 初始化系统权限
INSERT INTO tb_permissions (name, code, resource, action, description, is_menu, menu_url, menu_icon, sort_order) VALUES
-- 系统管理
('系统管理', 'SYSTEM', 'system', 'menu', '系统管理菜单', TRUE, '/system', 'system', 1),
('用户管理', 'USER_MANAGE', 'user', 'manage', '用户管理权限', TRUE, '/system/users', 'user', 2),
('角色管理', 'ROLE_MANAGE', 'role', 'manage', '角色管理权限', TRUE, '/system/roles', 'role', 3),
-- 设备管理
('设备管理', 'DEVICE', 'device', 'menu', '设备管理菜单', TRUE, '/device', 'device', 10),
('设备查看', 'DEVICE_VIEW', 'device', 'view', '查看设备信息', FALSE, NULL, NULL, 11),
('设备添加', 'DEVICE_ADD', 'device', 'add', '添加设备', FALSE, NULL, NULL, 12),
('设备编辑', 'DEVICE_EDIT', 'device', 'edit', '编辑设备', FALSE, NULL, NULL, 13),
('设备删除', 'DEVICE_DELETE', 'device', 'delete', '删除设备', FALSE, NULL, NULL, 14),
-- 监控管理
('实时监控', 'MONITORING', 'monitoring', 'menu', '实时监控菜单', TRUE, '/monitoring', 'monitor', 20),
('监控查看', 'MONITORING_VIEW', 'monitoring', 'view', '查看监控画面', FALSE, NULL, NULL, 21),
-- 报警管理
('报警中心', 'ALERT', 'alert', 'menu', '报警中心菜单', TRUE, '/alerts', 'alert', 30),
('报警查看', 'ALERT_VIEW', 'alert', 'view', '查看报警信息', FALSE, NULL, NULL, 31),
('报警处理', 'ALERT_HANDLE', 'alert', 'handle', '处理报警事件', FALSE, NULL, NULL, 32);

-- 初始化超级管理员用户
INSERT INTO tb_users (username, password, name, email, status) VALUES
('admin', '$2a$10$N.zmdr9k7uOCQb376NoUnuTJ8iAt6Z5EHsM8lE9lBOsl7iKTVEFDi', '系统管理员', 'admin@skyeye.com', 1);

-- 分配超级管理员角色
INSERT INTO tb_user_roles (user_id, role_id) VALUES
((SELECT id FROM tb_users WHERE username = 'admin'), (SELECT id FROM tb_roles WHERE code = 'SUPER_ADMIN'));

-- 为超级管理员角色分配所有权限
INSERT INTO tb_role_permissions (role_id, permission_id)
SELECT r.id, p.id FROM tb_roles r, tb_permissions p WHERE r.code = 'SUPER_ADMIN';
```

---

## 5. 开发工具配置

### 5.1 IDE配置

#### IntelliJ IDEA配置
1. **导入项目**
   - File → Open → 选择项目根目录
   - 等待Maven依赖下载完成

2. **配置代码格式**
   - File → Settings → Editor → Code Style → Java
   - 设置缩进为4个空格
   - 设置行长度为120字符

3. **配置数据库连接**
   - Database Tool Window → + → Data Source → PostgreSQL
   - 配置连接信息：
     - Host: localhost
     - Port: 5432
     - Database: skyeye
     - User: skyeye_app
     - Password: skyeye_app_2024

4. **配置运行配置**
   - Run → Edit Configurations → + → Spring Boot
   - Main class: com.skyeye.SkyEyeApplication
   - Active profiles: dev

#### VS Code配置
创建 `.vscode/settings.json`：
```json
{
    "java.configuration.updateBuildConfiguration": "interactive",
    "java.compile.nullAnalysis.mode": "automatic",
    "java.format.settings.url": ".vscode/java-formatter.xml",
    "spring-boot.ls.problem.application-properties.enabled": true,
    "files.exclude": {
        "**/target": true,
        "**/.classpath": true,
        "**/.project": true,
        "**/.settings": true,
        "**/.factorypath": true
    }
}
```

### 5.2 Git配置

#### .gitignore
```gitignore
# Maven
target/
pom.xml.tag
pom.xml.releaseBackup
pom.xml.versionsBackup
pom.xml.next
release.properties
dependency-reduced-pom.xml
buildNumber.properties
.mvn/timing.properties
.mvn/wrapper/maven-wrapper.jar

# IDE
.idea/
*.iws
*.iml
*.ipr
.vscode/
.settings/
.project
.classpath
.factorypath

# OS
.DS_Store
.DS_Store?
._*
.Spotlight-V100
.Trashes
ehthumbs.db
Thumbs.db

# Logs
logs/
*.log
*.log.*

# Runtime
*.pid
*.seed
*.pid.lock

# Application
application-local.yml
application-secret.yml
uploads/
temp/
```

---

## 6. 验证环境

### 6.1 运行项目
```bash
# 克隆项目（如果从Git仓库）
git clone <repository-url>
cd skyeye-monitoring

# 编译项目
mvn clean compile

# 运行测试
mvn test

# 启动应用
mvn spring-boot:run

# 或者
java -jar target/skyeye-monitoring-1.0.0-SNAPSHOT.jar
```

### 6.2 验证服务
```bash
# 检查应用是否启动
curl http://localhost:8080/actuator/health

# 预期响应
{
  "status": "UP",
  "components": {
    "db": {"status": "UP"},
    "redis": {"status": "UP"}
  }
}

# 检查API端点
curl http://localhost:8080/api/auth/login -X POST \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
```

### 6.3 数据库验证
```sql
-- 连接数据库
psql -U skyeye_app -d skyeye -h localhost

-- 检查表是否创建
\dt

-- 检查初始数据
SELECT * FROM tb_users;
SELECT * FROM tb_roles;

-- 退出
\q
```

---

## 7. 常见问题解决

### 7.1 数据库连接问题
```bash
# 检查PostgreSQL服务状态
sudo systemctl status postgresql

# 检查端口是否开放
netstat -an | grep 5432

# 检查pg_hba.conf配置
sudo nano /etc/postgresql/15/main/pg_hba.conf

# 添加或修改以下行
local   all             all                                     md5
host    all             all             127.0.0.1/32            md5
```

### 7.2 Redis连接问题
```bash
# 检查Redis服务状态
sudo systemctl status redis-server

# 检查Redis配置
redis-cli config get bind

# 如果需要，修改redis.conf
sudo nano /etc/redis/redis.conf
# 注释掉: # bind 127.0.0.1
# 或设置: bind 127.0.0.1 0.0.0.0
```

### 7.3 Maven依赖问题
```bash
# 清理并重新下载依赖
mvn clean install -U

# 删除本地仓库中的问题依赖
rm -rf ~/.m2/repository/org/springframework

# 重新下载
mvn dependency:resolve
```

### 7.4 JDK版本问题
```bash
# 检查当前Java版本
java -version
javac -version

# 检查JAVA_HOME
echo $JAVA_HOME

# 如果版本不对，切换JDK
sudo update-alternatives --config java
```

---

## 8. 开发建议

### 8.1 开发流程
1. **创建功能分支**
   ```bash
   git checkout -b feature/user-management
   ```

2. **编写代码**
   - 遵循项目代码规范
   - 编写单元测试
   - 添加必要注释

3. **本地测试**
   ```bash
   mvn test
   mvn spring-boot:run
   ```

4. **提交代码**
   ```bash
   git add .
   git commit -m "feat: implement user management module"
   git push origin feature/user-management
   ```

### 8.2 调试技巧
- 使用IDE断点调试
- 查看应用日志：`tail -f logs/skyeye.log`
- 使用Actuator监控端点
- 使用数据库客户端查看数据变化

### 8.3 性能优化
- 启用JPA查询日志分析SQL性能
- 使用Redis缓存频繁查询的数据
- 监控应用内存使用情况
- 定期分析慢查询日志

---

## 9. 总结

本指南详细说明了SkyEye智能监控系统的开发环境搭建过程，包括：

1. **基础软件安装**：JDK、Maven、PostgreSQL、Redis等
2. **项目初始化**：Spring Boot项目创建和配置
3. **数据库设置**：表结构创建和初始数据
4. **开发工具配置**：IDE和Git配置
5. **环境验证**：确保所有组件正常工作

按照本指南操作，可以快速搭建完整的开发环境，为后续开发工作打下坚实基础。 